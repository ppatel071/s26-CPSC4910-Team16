{% extends "base.html" %}

{% block title %}Password Reset{% endblock %}

{% block content %}
<form method = "POST" id="reset-password-form">
  <label>Confirm Current Password:</label>
  <input type = "password" name = "current_password" required><br><br>

  <label>New Password:</label>
  <input type = "password" id="new_password" name = "new_password" required><br><br>

  <label>Confirm New Password:</label>
  <input type = "password" id="confirm_new_password" name = "confirm_new_password" required><br><br>

  <button type = "submit">Reset Password</button><br>
  <a href="{{ url_for('auth.home') }}">Cancel</a>
</form>
<p><a href="{{ url_for('auth.home') }}">Back to Home</a></p>
{% endblock %}

{% block scripts %}
<script>
  const resetForm = document.getElementById('reset-password-form');
  const currentPasswordInput = document.getElementsByName('current_password')[0];
  const newPasswordInput = document.getElementById('new_password');
  const confirmNewPasswordInput = document.getElementById('confirm_new_password');

  function validateResetPasswords() {
    if (newPasswordInput.value !== confirmNewPasswordInput.value) {
      confirmNewPasswordInput.setCustomValidity('New passwords do not match');
    } else {
      confirmNewPasswordInput.setCustomValidity('');
    }

    if (
      currentPasswordInput.value &&
      newPasswordInput.value &&
      currentPasswordInput.value === newPasswordInput.value
    ) {
      newPasswordInput.setCustomValidity('New password must be different from current password');
    } else {
      newPasswordInput.setCustomValidity('');
    }
  }

  currentPasswordInput.addEventListener('input', validateResetPasswords);
  newPasswordInput.addEventListener('input', validateResetPasswords);
  confirmNewPasswordInput.addEventListener('input', validateResetPasswords);
  resetForm.addEventListener('submit', validateResetPasswords);
</script>
{% endblock %}
